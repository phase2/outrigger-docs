<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Phase2">
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <title>Architecture - Outrigger Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Architecture";
    var mkdocs_page_input_path = "appendix/architecture.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-305109-83', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Outrigger Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../getting-started/system-requirements/">System Requirements</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting-started/mac-installation/">Mac Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting-started/linux-installation/">Linux Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting-started/windows-installation/">Windows Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting-started/first-steps/">First Steps</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Project Setup</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../project-setup/key-concepts/">Key Concepts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/new-projects/">New Projects</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/existing-projects/">Existing Projects</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/project-configuration/">Project Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/filesystem-sync/">Filesystem Sync</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/docker-images/">Docker Images</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Common Tasks</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../common-tasks/starting-your-project-containers/">Starting your project containers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/stopping-containers-and-cleanup/">Stopping containers and cleanup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/using-the-build-container/">Using the build container</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/working-with-volumes/">Working with Volumes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/working-offline/">Working Offline</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/ssh-into-a-container/">SSH into a container</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/customizing-container-configuration/">Changing container configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/using-watches/">Using watches</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/using-xdebug-with-outrigger/">Using Xdebug with Outrigger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/accessing-logs/">Accessing logs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/inter-vm-communication/">Accessing containers from other VMs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/ssh-keys-for-private-repos/">SSH Keys for private repos</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/setting-up-mail/">Setting up mail</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/dns-resolution/">DNS Resolution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/upgrading-rig/">Upgrading Rig</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/multiple-docker-machines/">Multiple Docker Machines</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/routine-image-maintenance/">Routine Image Maintenance</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/creating-your-own-images/">Creating your own images</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">FAQ</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../faq/general/">General</a>
                </li>
                <li class="">
                    
    <a class="" href="../../faq/troubleshooting/">Troubleshooting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../faq/docker-for-mac/">Docker for Mac</a>
                </li>
                <li class="">
                    
    <a class="" href="../../faq/how-to-contribute/">How to contribute</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Appendix</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../glossary/">Glossary</a>
                </li>
                <li class="">
                    
    <a class="" href="../return-codes/">Return Codes</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Architecture</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#architecture">Architecture</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#containerization">Containerization</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../background/">Background</a>
                </li>
                <li class="">
                    
    <a class="" href="../library/">Library</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Outrigger Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Appendix &raquo;</li>
        
      
    
    <li>Architecture</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/phase2/outrigger-docs/edit/master/docs/appendix/architecture.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="architecture">Architecture</h1>
<p>Outrigger uses a containerization based approach to providing a project environment. Project services running as containers
are combined with configuration for persistent data storage, DNS services and network manipulation which allows for easy
access via names like service.project.vm rather than IP addresses.</p>
<p>The Outrigger CLI facilitates setting up a VM to act as a container host on systems which can not host containers natively.
It also configures the VM with the following:</p>
<ul>
<li>Filesystem sharing for high performance file access of the host machine</li>
<li>Container initiation for DNS services</li>
<li>Network and name resolution configuration</li>
</ul>
<p>Layered with this core are a set of docker images which provide common project services such as a web server along with
the ability to configure these services with commonly desired development options. Any docker image can be used if desired.</p>
<p>Docker Compose is used to control containers to provide a complete environment and a set of Yeoman based generators are
used to help initial project setup to ensure all pieces fit together using the current best known options..</p>
<h2 id="containerization">Containerization</h2>
<p>In order to provide lightweight environments and tooling we use a technical approach called containers.
Containers attempt to move the unit of environment from server to application. This allows separation of concerns between
how an application is configured, how the containers communicate with each other, and where the containers are deployed.
Take an advanced Drupal stack that includes Apache/PHP, MySQL, Memcache, and SOLR. With each component configured to run
in its own container, the containers can all run on a single VM for local development and be spread across multiple
servers for an optimized production deployment. Let us briefly touch on the technology we will be using and how it
conceptually fits together.</p>
<h3 id="docker">Docker</h3>
<p>The container implementation we use is called Docker which is explained in the intro: <a href="https://www.docker.com/whatisdocker">What is Docker</a>?
This is the way we capture environment units for our application/services and share them with everyone on the team.
Environments are captured as images, similar to a VM, so when anyone runs that image they all start with the exact same
set of files. For example, nearly every project needs a web server so we have a container image that can be run
to provide that service. Our Docker images are also set up to allow for configuration adjustment to enable common
development options.</p>
<h3 id="rig">rig</h3>
<p>This is a project that glues all of the hosting aspects of these tools together into an easy to use unit. You can find
rig in a GitHub repository <a href="https://github.com/phase2/rig">here</a>. There are 2 basic services that rig provides:</p>
<h4 id="manage-virtual-machines-for-running-containers">Manage virtual machines for running containers</h4>
<p>The rig binary will manage the creation/configuration/upgrade/start/stop of boot2docker virtual machines (a.k.a
Docker Hosts) via docker-machine. It ensures that the docker-machine virtual machine is the right version, is named
correctly and configured to run efficiently within VirtualBox, VMWare Fusion or xhyve.</p>
<h4 id="nice-dns-names-and-routing-for-running-containers">Nice DNS names and routing for running containers</h4>
<p>Once there is a safe environment to run our containers we need a way to route traffic to them and provide easy to
use/remember domain names to make accessing these services simple. Domain names for containers are set in the
docker-compose YAML files using configuration that the <strong>dnsdock</strong> container reads to create a mapping between domain
name and container.</p>
<p>We use <strong>dnsdock</strong> running as a container within the Docker Host. The <strong>dnsdock</strong> service, which listens on
172.17.0.1:53535. The <strong>dnsdock</strong> container resolves the *.vm domain names to the IP addresses of the containers.</p>
<p>Internal container names will look like <em>web.openatrium.vm</em>. All Outrigger containers will carry the <strong>.vm</strong> extension
for name resolution. There is additional information in <a href="../../common-tasks/dns-resolution/">DNS Resolution</a>.</p>
<h3 id="docker-hub">Docker Hub</h3>
<p>Docker Hub is where container images are stored and retrieved when your local machine does not already have a copy of
the requested container image. Docker Hub can be thought of like GitHub or BitBucket, and Docker Hub images can be thought
of as git repositories. We can make new versions of the images and they can be pushed and pulled to the Docker Hub service.</p>
<h3 id="container-configuration">Container Configuration</h3>
<p>If a container wants to offer configurable options it will document how to control it within the README or via Environment
variables in the Dockerfile itself. See our Apache / PHP <a href="https://hub.docker.com/r/phase2/apache-php/~/dockerfile/">Dockerfile</a>
for an example. In this Docker Image, passing environment variables can override the PHP memory limit. Those variables
can either be passed on the command line when executing a <code>docker run</code> command directly, or in the <code>environment</code> section
of a docker-compose file. Documentation entries within the <strong>Common Tasks</strong> section provide additional approaches to
container configuration.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../background/" class="btn btn-neutral float-right" title="Background">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../return-codes/" class="btn btn-neutral" title="Return Codes"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/phase2/outrigger-docs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../return-codes/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../background/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
