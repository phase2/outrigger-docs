<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Phase2">
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <title>Linux Installation - Outrigger Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Linux Installation";
    var mkdocs_page_input_path = "getting-started/linux-installation.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-305109-83', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Outrigger Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../system-requirements/">System Requirements</a>
                </li>
                <li class="">
                    
    <a class="" href="../mac-installation/">Mac Installation</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Linux Installation</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#linux-installation">Linux Installation</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#install-outrigger">Install Outrigger</a></li>
        
            <li><a class="toctree-l4" href="#linux-requirements">Linux Requirements</a></li>
        
            <li><a class="toctree-l4" href="#linux-installation-on-fedoracentos">Linux installation on Fedora/Centos</a></li>
        
            <li><a class="toctree-l4" href="#linux-installation-on-ubuntudebian">Linux installation on Ubuntu/Debian</a></li>
        
            <li><a class="toctree-l4" href="#automated-linux-dns-configuration-options">Automated Linux DNS configuration options</a></li>
        
            <li><a class="toctree-l4" href="#manual-dns-resolution-options">Manual DNS resolution options</a></li>
        
            <li><a class="toctree-l4" href="#verifying-dns-is-working">Verifying DNS is working</a></li>
        
            <li><a class="toctree-l4" href="#troubleshooting">Troubleshooting</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../windows-installation/">Windows Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../first-steps/">First Steps</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Project Setup</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../project-setup/key-concepts/">Key Concepts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/new-projects/">New Projects</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/existing-projects/">Existing Projects</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/project-configuration/">Project Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/filesystem-sync/">Filesystem Sync</a>
                </li>
                <li class="">
                    
    <a class="" href="../../project-setup/docker-images/">Docker Images</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Common Tasks</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../common-tasks/starting-your-project-containers/">Starting your project containers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/stopping-containers-and-cleanup/">Stopping containers and cleanup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/using-the-build-container/">Using the build container</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/working-with-volumes/">Working with Volumes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/working-offline/">Working Offline</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/ssh-into-a-container/">SSH into a container</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/customizing-container-configuration/">Changing container configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/using-watches/">Using watches</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/using-xdebug-with-outrigger/">Using Xdebug with Outrigger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/accessing-logs/">Accessing logs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/inter-vm-communication/">Accessing containers from other VMs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/ssh-keys-for-private-repos/">SSH Keys for private repos</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/setting-up-mail/">Setting up mail</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/dns-resolution/">DNS Resolution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/upgrading-rig/">Upgrading Rig</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/multiple-docker-machines/">Multiple Docker Machines</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/routine-image-maintenance/">Routine Image Maintenance</a>
                </li>
                <li class="">
                    
    <a class="" href="../../common-tasks/creating-your-own-images/">Creating your own images</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">FAQ</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../faq/general/">General</a>
                </li>
                <li class="">
                    
    <a class="" href="../../faq/troubleshooting/">Troubleshooting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../faq/docker-for-mac/">Docker for Mac</a>
                </li>
                <li class="">
                    
    <a class="" href="../../faq/how-to-contribute/">How to contribute</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Appendix</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../appendix/glossary/">Glossary</a>
                </li>
                <li class="">
                    
    <a class="" href="../../appendix/return-codes/">Return Codes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../appendix/architecture/">Architecture</a>
                </li>
                <li class="">
                    
    <a class="" href="../../appendix/background/">Background</a>
                </li>
                <li class="">
                    
    <a class="" href="../../appendix/library/">Library</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Outrigger Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Getting Started &raquo;</li>
        
      
    
    <li>Linux Installation</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/phase2/outrigger-docs/edit/master/docs/getting-started/linux-installation.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="linux-installation">Linux Installation</h1>
<p>When running Docker containers on Linux, it is not necessary to run the Docker Machine VM. The instructions here describe 
how to run Outrigger projects on Linux.</p>
<h2 id="install-outrigger">Install Outrigger</h2>
<ul>
<li>Go to the <a href="https://github.com/phase2/rig/releases">Outrigger Releases</a> page and download the <code>.rpm</code>, <code>.deb</code>, 
or grab the <code>linux-amd64.tar.gz</code> binary directly and install it in <code>/usr/local/bin</code></li>
</ul>
<h2 id="linux-requirements">Linux Requirements</h2>
<ol>
<li>For automated DNS resolution, the use of one of two options to resolve DNS queries to the dnsdock container</li>
</ol>
<h2 id="linux-installation-on-fedoracentos">Linux installation on Fedora/Centos</h2>
<ol>
<li><a href="https://docs.docker.com/engine/installation/linux/fedora/">Install Docker for Fedora</a> or 
<a href="https://docs.docker.com/engine/installation/linux/centos/">Install Docker for CentOS</a></li>
<li><a href="https://docs.docker.com/compose/install/">Install Docker Compose</a></li>
<li>Set the DNS configuration for Docker<ul>
<li>We need to add Docker daemon configuration</li>
<li><code>sudo vi /etc/docker/daemon.conf</code></li>
<li>In that file put (or integrate) the following:    </li>
</ul>
</li>
</ol>
<pre><code class="json">{
    &quot;dns&quot;: [ &quot;172.17.0.1&quot; ]
}
</code></pre>

<ol>
<li>Set up the docker0 network as trusted<ul>
<li><code>sudo firewall-cmd --zone=trusted --add-interface=docker0 &amp;&amp; sudo firewall-cmd --zone=trusted --add-interface=docker0 --permanent</code></li>
</ul>
</li>
<li>Restart the docker daemon<ul>
<li><code>sudo systemctl restart docker</code></li>
</ul>
</li>
</ol>
<h2 id="linux-installation-on-ubuntudebian">Linux installation on Ubuntu/Debian</h2>
<ol>
<li><a href="https://docs.docker.com/engine/installation/linux/ubuntu/">Install Docker for Ubuntu</a> or 
<a href="https://docs.docker.com/engine/installation/linux/debian/">Install Docker for Debian</a></li>
<li><a href="https://docs.docker.com/compose/install/">Install Docker Compose</a></li>
<li>Set the DNS configuration for Docker<ul>
<li>We need to add Docker daemon configuration</li>
<li><code>sudo vi /etc/docker/daemon.conf</code></li>
<li>In that file put (or integrate) the following:    </li>
</ul>
</li>
</ol>
<pre><code class="json">{
    &quot;dns&quot;: [ &quot;172.17.0.1&quot; ]
}
</code></pre>

<ol>
<li>Restart the docker daemon<ul>
<li><code>sudo systemctl restart docker</code></li>
</ul>
</li>
</ol>
<h2 id="automated-linux-dns-configuration-options">Automated Linux DNS configuration options</h2>
<p>Outrigger will help automate the setup of DNS (via <code>rig start</code> and <code>rig dns</code>) if you are using one of the following options for name resolution</p>
<ol>
<li><a href="https://wiki.archlinux.org/index.php/dnsmasq#NetworkManager">dnsmasq via NetworkManager</a></li>
<li><a href="https://github.com/azukiapp/libnss-resolver">libnss-resolver</a></li>
</ol>
<h2 id="manual-dns-resolution-options">Manual DNS resolution options</h2>
<h3 id="dnsdock-as-main-resolver">DNSDock as main resolver</h3>
<p>This method will probably only work well if this is a fixed computer or server with a consistent single upstream DNS 
server. If you meet these criteria, you can very easily use this to set up .vm resolution for containers an delegate the 
rest to your normal DNS server.</p>
<p>This example assumes that the upstream DNS server for a Linux workstation is 192.168.0.1.</p>
<ol>
<li>Run the dnsdock container, specifying your upstream DNS server at the end.</li>
</ol>
<pre><code class="bash">docker run -d \
  --name=dnsdock \
  --restart=always \
  -l com.dnsdock.name=dnsdock \
  -l com.dnsdock.image=outrigger \
  -p 172.17.0.1:53:53/udp \
  -v /var/run/docker.sock:/var/run/docker.sock \
  aacebedo/dnsdock:v1.16.4-amd64 --domain=vm
</code></pre>

<ol>
<li>Configure 172.17.0.1 as your first DNS resolver in your network configuration. The method for doing this may differ 
based on whether you are using a desktop environment or running Linux on a server, but that nameserver should end up as 
the first 'nameserver' line in your <code>/etc/resolv.conf</code> file.</li>
<li>Running dnsdock as a service<ul>
<li>Create the file <code>/etc/systemd/system/dnsdock.service</code> with the following contents</li>
</ul>
</li>
</ol>
<pre><code class="bash">[Unit]
Description=DNSDock
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
ExecStartPre=-/usr/bin/docker kill dnsdock
ExecStartPre=-/usr/bin/docker rm dnsdock
ExecStart=/usr/bin/docker run --rm --name dnsdock -v /var/run/docker.sock:/var/run/docker.sock -l com.dnsdock.name=dnsdock -l com.dnsdock.image=outrigger -p 172.17.0.1:53:53/udp aacebedo/dnsdock:v1.16.4-amd64  --domain=vm
ExecStop=/usr/bin/docker stop dnsdock
Restart=always
RestartSec=30

[Install]
WantedBy=multi-user.target
</code></pre>

<ol>
<li>Ensure Docker is registered with systemctl<ul>
<li><code>systemctl enable docker</code></li>
</ul>
</li>
<li>Register dnsdock service: <ul>
<li><code>systemctl enable dnsdock &amp;&amp; systemctl daemon-reload</code></li>
</ul>
</li>
<li>Now you can start/stop the dnsdock service with <ul>
<li><code>systemctl [start|stop] dnsdock</code></li>
</ul>
</li>
<li>You can also check its status <ul>
<li><code>systemctl status dnsdock</code></li>
</ul>
</li>
</ol>
<h2 id="verifying-dns-is-working">Verifying DNS is working</h2>
<p>Once you have your environment set up, you can use the following tests to ensure things are running properly.</p>
<ul>
<li><code>dig @172.17.0.1 dnsdock.outrigger.vm.</code><ul>
<li>You should get a 172.17.0.0/16 address</li>
</ul>
</li>
<li><code>ping dnsdock.outrigger.vm</code><ul>
<li>You should get echo replies from a 172.17.0.0/16 address</li>
</ul>
</li>
<li><code>getent hosts dnsdock.outrigger.vm</code><ul>
<li>You should get a 172.17.0.0/16 address</li>
</ul>
</li>
<li>Verify DNS works between containers<ul>
<li>Open a shell for a second test container<ul>
<li><code>docker run --rm -l com.dnsdock.name=test -l com.dnsdock.image=outrigger -it alpine sh</code></li>
</ul>
</li>
<li>From its prompt: <ul>
<li><code>ping test.outrigger.vm</code></li>
<li>You should get echo replies from a 172.17.0.0/16 address</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="bind-address-already-in-use"><code>bind: address already in use</code></h3>
<p>Make sure you are not running a service which binds all mapped IPs.  For example,</p>
<pre><code class="bash">&gt; docker run -d \
  --name=dnsdock \
  --restart=always \
  -l com.dnsdock.name=dnsdock \
  -l com.dnsdock.image=outrigger \
  -p 172.17.0.1:53:53/udp \
  -v /var/run/docker.sock:/var/run/docker.sock \
  aacebedo/dnsdock:v1.16.4-amd64 --domain=vm

  6aa76d0df98ede7e01c1cef53f105a79a60bab72ee905a1acd76ad57d4aeb014
  docker: Error response from daemon: driver failed programming external connectivity on endpoint dnsdock
  (62b3788e1f60530d1f468b46833f0bf8227955557da3a135356184f5b7d57bde): Error starting userland proxy: listen
  udp 172.17.0.1:53: bind: address already in use.
</code></pre>

<p>In this case the culprit was <code>bind9/named</code> was attaching to all interfaces (on port 53)</p>
<ul>
<li>The solution<ul>
<li><code>systemctl stop bind9</code></li>
</ul>
</li>
<li>To avoid having to stop <code>bind9</code> every session<ul>
<li><code>systemctl disable bind9</code></li>
</ul>
</li>
<li>You may need to restart NetworkManager<ul>
<li><code>systemctl restart NetworkManager</code></li>
</ul>
</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../windows-installation/" class="btn btn-neutral float-right" title="Windows Installation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../mac-installation/" class="btn btn-neutral" title="Mac Installation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/phase2/outrigger-docs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../mac-installation/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../windows-installation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
